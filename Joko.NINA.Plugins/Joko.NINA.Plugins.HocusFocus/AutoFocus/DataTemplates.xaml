<ResourceDictionary
    x:Class="NINA.Joko.Plugins.HocusFocus.AutoFocus.DataTemplates"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:controls="clr-namespace:NINA.Joko.Plugins.HocusFocus.Controls"
    xmlns:hfrules="clr-namespace:NINA.Joko.Plugins.HocusFocus.ValidationRules"
    xmlns:local="clr-namespace:NINA.Joko.Plugins.HocusFocus.AutoFocus"
    xmlns:ninactrl="clr-namespace:NINACustomControlLibrary;assembly=NINACustomControlLibrary"
    xmlns:ns="clr-namespace:NINA.Core.Locale;assembly=NINA.Core"
    xmlns:oxy="clr-namespace:OxyPlot.Wpf;assembly=OxyPlot.Wpf"
    xmlns:rules="clr-namespace:NINA.Core.Utility.ValidationRules;assembly=NINA.Core"
    xmlns:s="clr-namespace:System;assembly=mscorlib">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="../Resources/OptionsDataTemplates.xaml" />
    </ResourceDictionary.MergedDictionaries>
    <TextBlock x:Key="ClearAnalyses_Tooltip" Text="Clear charts and analyses. This can be useful if the chart rendering is slowing NINA down, especially after you're finished with aberration inspection" />
    <TextBlock x:Key="DetailedAnalysis_Tooltip" Text="Run an autofocus to detect various aberrations, such as tilt, incorrect backfocus, and field curvature" />
    <TextBlock x:Key="SimpleAnalysis_Tooltip" Text="Take a single exposure to produce a FWHM contour map and Eccentricity vector field" />
    <TextBlock x:Key="SimpleAnalysisExposureDuration_Tooltip" Text="How long of an exposure to take for analysis. Defaults to the Auto Focus exposure duration if not set" />
    <TextBlock x:Key="LoopingExposureAnalysis_Tooltip" Text="If enabled, repeatedly take and analyze exposures" />
    <TextBlock x:Key="StepCount_Tooltip" Text="The minimum number of data points needed on each side of the AutoFocus curve minimum. Uses the value set for AutoFocus if blank" />
    <TextBlock x:Key="StepSize_Tooltip" Text="How many focuser steps in between each data point when doing an AutoFocus. Uses the value set for AutoFocus if blank" />
    <TextBlock x:Key="FramesPerPoint_Tooltip" Text="How many exposures to average together for each focuser point. Uses the value set for AutoFocus if blank" />
    <TextBlock x:Key="AutoFocusTimeoutSeconds_Tooltip" Text="How long, in seconds, after which AutoFocus should time out and fail. Uses the value set for AutoFocus if blank" />
    <TextBlock x:Key="NumRegionsWide_Tooltip" Text="How many cells wide to divide the sensor pixels when generating a grid of eccentricity vectors. This value must be an odd, positive integer, and the height will be calculated proportionally from it based on the sensor resolution" />
    <TextBlock x:Key="MicronsPerFocuserStep_Tooltip" Text="How much the focuser moves per step, in microns. If this is set, the adjustment chart will include adjustments in microns" />
    <TextBlock x:Key="EccentricityColorMapEnabled_Tooltip" Text="Enable color on the eccentricity map" />
    <TextBlock x:Key="MouseOnChartsEnabled_Tooltip" Text="Enable mouse events on charts to scroll, pan, and zoom. Disable this if you don't want the charts to intercept mouse actions" />
    <TextBlock x:Key="SlewToZenith_Tooltip" Text="Slews to zenith while leaving tracking running. Doing this is optional, but you may find better seeing conditions and consistency as far from the horizon as possible" />
    <TextBlock x:Key="SensorCurveModelEnabled_Tooltip" Text="In addition to analyzing AutoFocus curves for the corners and center, create a paraboloid model of the sensor by creating focus curves for every star. This enables calculation of centering error and curvature, and is similar to the type of analysis done by CCD Inspector" />

    <TextBlock x:Key="SensorModel_Tilt_Tooltip" Text="The angle the sensor is tilted. 0 indicates no tilt, and values here are typically very small" />
    <TextBlock x:Key="SensorModel_CriticalFocus_Tooltip" Text="The focuser distance a pixel can be from optimal focus before the effects can be noticed. This value increases with larger (slower) F/ratios, which can tolerate more curvature before affecting image quality" />
    <TextBlock x:Key="SensorModel_CurvatureRadius_Tooltip" Text="Near focus, the base of the sensor parabola is close to a sphere. This value represents the radius of that sphere. Larger values indicate flatter curves, which are better." />
    <TextBlock x:Key="SensorModel_MeanFocuserPosition_Tooltip" Text="The weighted mean focuser position under the sensor curve, which serves as a focus point where pixels throughout the sensor have minimum absolute distance from optimal focus" />
    <TextBlock x:Key="SensorModel_CurvatureEffect_Tooltip" Text="The nominal distance from the corner of the sensor to the center, due purely to the modeled curvature. Curvature effect is more exaggerated on larger sensors." />
    <TextBlock x:Key="SensorModel_TiltEffect_Tooltip" Text="The maximum nominal distance from the corners of the sensor to the center, due purely to the modeled tilt." />
    <TextBlock x:Key="SensorModel_AutoFocusOffset_Tooltip" Text="The number of focuser steps between the AutoFocus position and the Sensor Mean Focuser Position. You can set this value in the AF Offset setting in Auto Focus Options." />
    <TextBlock x:Key="SensorModel_StarsInModel_Tooltip" Text="The number of stars used in the sensor model. Each star needs to be matched across at least 5 of the frames, and some star fits are rejected as outliers during modeling." />

    <DataTemplate x:Key="NINA.Joko.Plugins.HocusFocus.AutoFocus.HocusFocusVM_Dockable">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition MinHeight="150" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <oxy:Plot
                Background="{StaticResource BackgroundBrush}"
                PlotAreaBackground="{StaticResource BackgroundBrush}"
                PlotAreaBorderColor="{Binding Path=Color, Source={StaticResource BorderBrush}}"
                TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}">

                <oxy:Plot.Axes>
                    <oxy:LinearAxis
                        AxislineColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                        EndPosition="1"
                        IsPanEnabled="False"
                        IsZoomEnabled="False"
                        MajorGridlineColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}, Converter={StaticResource SetAlphaToColorConverter}, ConverterParameter=60}"
                        MajorGridlineStyle="LongDash"
                        MaximumPadding="0.1"
                        MinimumPadding="0.1"
                        Position="Left"
                        StartPosition="0"
                        TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                        TicklineColor="{Binding Path=Color, Source={StaticResource SecondaryBrush}}" />

                    <oxy:LinearAxis
                        AxislineColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                        EndPosition="1"
                        IsPanEnabled="True"
                        IsZoomEnabled="False"
                        MajorGridlineColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}, Converter={StaticResource SetAlphaToColorConverter}, ConverterParameter=60}"
                        MajorGridlineStyle="LongDash"
                        MaximumPadding="0.1"
                        MinimumPadding="0.1"
                        Position="Bottom"
                        StartPosition="0"
                        TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                        TicklineColor="{Binding Path=Color, Source={StaticResource SecondaryBrush}}" />
                </oxy:Plot.Axes>
                <oxy:Plot.Series>
                    <oxy:ScatterErrorSeries
                        DataFieldX="FocusPosition"
                        DataFieldY="HFR"
                        ErrorBarColor="{Binding Path=Color, Source={StaticResource NotificationErrorBrush}}"
                        ErrorBarStopWidth="2"
                        ErrorBarStrokeThickness="2"
                        ItemsSource="{Binding FocusPoints}"
                        MarkerFill="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                        MarkerType="Circle" />
                    <oxy:LineSeries
                        DataFieldX="FocusPosition"
                        DataFieldY="HFR"
                        ItemsSource="{Binding PlotFocusPoints}"
                        Color="{Binding Path=Color, Source={StaticResource SecondaryBrush}}" />
                </oxy:Plot.Series>
                <oxy:Plot.Annotations>
                    <oxy:LineAnnotation Intercept="{Binding TrendlineFitting.LeftTrend.Offset}" Slope="{Binding TrendlineFitting.LeftTrend.Slope}">
                        <oxy:LineAnnotation.Color>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>Trendline</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:LineAnnotation.Color>
                    </oxy:LineAnnotation>
                    <oxy:LineAnnotation Intercept="{Binding TrendlineFitting.RightTrend.Offset}" Slope="{Binding TrendlineFitting.RightTrend.Slope}">
                        <oxy:LineAnnotation.Color>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>Trendline</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:LineAnnotation.Color>
                    </oxy:LineAnnotation>
                    <oxy:FunctionAnnotation Equation="{Binding QuadraticFitting.Fitting}">
                        <oxy:FunctionAnnotation.Color>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>QuadraticFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:FunctionAnnotation.Color>
                    </oxy:FunctionAnnotation>
                    <oxy:FunctionAnnotation Equation="{Binding HyperbolicFitting.Fitting}">
                        <oxy:FunctionAnnotation.Color>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>HyperbolicFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:FunctionAnnotation.Color>
                    </oxy:FunctionAnnotation>
                    <oxy:FunctionAnnotation Equation="{Binding GaussianFitting.Fitting}">
                        <oxy:FunctionAnnotation.Color>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>GaussianFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:FunctionAnnotation.Color>
                    </oxy:FunctionAnnotation>
                    <oxy:PointAnnotation
                        Fill="{Binding Path=Color, Source={StaticResource NotificationErrorBrush}}"
                        Shape="Diamond"
                        Stroke="{Binding Path=Color, Source={StaticResource NotificationErrorBrush}}"
                        X="{Binding FinalFocusPoint.X}"
                        Y="{Binding FinalFocusPoint.Y}" />
                    <oxy:PointAnnotation
                        Shape="Circle"
                        X="{Binding QuadraticFitting.Minimum.X}"
                        Y="{Binding QuadraticFitting.Minimum.Y}">
                        <oxy:PointAnnotation.Fill>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>QuadraticFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:PointAnnotation.Fill>
                        <oxy:PointAnnotation.Stroke>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>QuadraticFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:PointAnnotation.Stroke>
                    </oxy:PointAnnotation>
                    <oxy:PointAnnotation
                        Shape="Circle"
                        X="{Binding HyperbolicFitting.Minimum.X}"
                        Y="{Binding HyperbolicFitting.Minimum.Y}">
                        <oxy:PointAnnotation.Fill>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>HyperbolicFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:PointAnnotation.Fill>
                        <oxy:PointAnnotation.Stroke>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>HyperbolicFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:PointAnnotation.Stroke>
                    </oxy:PointAnnotation>
                    <oxy:PointAnnotation
                        Shape="Circle"
                        X="{Binding GaussianFitting.Maximum.X}"
                        Y="{Binding GaussianFitting.Maximum.Y}">
                        <oxy:PointAnnotation.Fill>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>GaussianFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:PointAnnotation.Fill>
                        <oxy:PointAnnotation.Stroke>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>GaussianFitting</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:PointAnnotation.Stroke>
                    </oxy:PointAnnotation>
                    <oxy:PointAnnotation
                        Shape="Circle"
                        X="{Binding TrendlineFitting.Intersection.X}"
                        Y="{Binding TrendlineFitting.Intersection.Y}">
                        <oxy:PointAnnotation.Fill>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>Trendline</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:PointAnnotation.Fill>
                        <oxy:PointAnnotation.Stroke>
                            <MultiBinding Converter="{StaticResource AFFittingToColorConverter}">
                                <Binding>
                                    <Binding.Source>
                                        <s:String>Trendline</s:String>
                                    </Binding.Source>
                                </Binding>
                                <Binding Path="AutoFocusChartMethod" />
                                <Binding Path="AutoFocusChartCurveFitting" />
                            </MultiBinding>
                        </oxy:PointAnnotation.Stroke>
                    </oxy:PointAnnotation>
                </oxy:Plot.Annotations>
            </oxy:Plot>
            <StackPanel Grid.Row="1" Orientation="Vertical">
                <Border
                    Margin="0,5,0,0"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0"
                    Visibility="{Binding LastAutoFocusPoint.Timestamp, Converter={StaticResource DateTimeZeroToVisibilityCollapsedConverter}}">
                    <UniformGrid VerticalAlignment="Center" Columns="2">
                        <TextBlock Text="{ns:Loc LblTime}" />
                        <TextBlock Margin="5,0,0,0" Text="{Binding LastAutoFocusPoint.Timestamp, StringFormat='{}{0:yyyy-MM-dd HH:mm:ss}'}" />
                    </UniformGrid>
                </Border>
                <Border
                    Margin="0,5,0,0"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0"
                    Visibility="{Binding FinalFocuserPosition, Converter={StaticResource HF_IntNegativeToVisibilityConverter}}">
                    <UniformGrid VerticalAlignment="Center" Columns="2">
                        <TextBlock Text="{ns:Loc LblPosition}" />
                        <StackPanel
                            Margin="5,0,0,0"
                            Orientation="Horizontal"
                            Visibility="{Binding LastAutoFocusPoint.Focuspoint.X, Converter={StaticResource HF_DoubleZeroToVisibilityConverter}}">
                            <TextBlock Text="{Binding InitialFocuserPosition}" Visibility="{Binding InitialFocuserPosition, Converter={StaticResource HF_IntNegativeToVisibilityConverter}}" />
                            <TextBlock Text=" -&gt; " Visibility="{Binding InitialFocuserPosition, Converter={StaticResource HF_IntNegativeToVisibilityConverter}}" />
                            <TextBlock Text="{Binding FinalFocuserPosition}" />
                        </StackPanel>
                    </UniformGrid>
                </Border>
                <Border Visibility="{Binding InitialHFR, Converter={StaticResource HF_DoubleZeroToVisibilityConverter}}">
                    <Border
                        Margin="0,5,0,0"
                        BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="0"
                        Visibility="{Binding FinalHFR, Converter={StaticResource HF_InverseDoubleZeroToVisibilityConverter}}">
                        <UniformGrid VerticalAlignment="Center" Columns="2">
                            <TextBlock Text="Start HFR" />
                            <TextBlock Margin="5,0,0,0" Text="{Binding InitialHFR, StringFormat=\{0:0.00\}}" />
                        </UniformGrid>
                    </Border>
                </Border>
                <Border
                    Margin="0,5,0,0"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0"
                    Visibility="{Binding FinalHFR, Converter={StaticResource HF_DoubleZeroToVisibilityConverter}}">
                    <UniformGrid VerticalAlignment="Center" Columns="2">
                        <TextBlock Text="HFR Change" />
                        <StackPanel Margin="5,0,0,0" Orientation="Horizontal">
                            <TextBlock Text="{Binding InitialHFR, StringFormat=\{0:0.00\}}" />
                            <TextBlock Text=" -&gt; " />
                            <TextBlock Text="{Binding FinalHFR, StringFormat=\{0:0.00\}}" />
                        </StackPanel>
                    </UniformGrid>
                </Border>
                <Border
                    Margin="0,5,0,0"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0"
                    Visibility="{Binding LastAutoFocusPoint.Focuspoint.Y, Converter={StaticResource HF_DoubleZeroToVisibilityConverter}}">
                    <UniformGrid VerticalAlignment="Center" Columns="2">
                        <TextBlock Text="Estimated Final HFR" />
                        <TextBlock Margin="5,0,0,0" Text="{Binding LastAutoFocusPoint.Focuspoint.Y, StringFormat=\{0:0.00\}}" />
                    </UniformGrid>
                </Border>
                <Border
                    Margin="0,5,0,0"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0"
                    Visibility="{Binding LastAutoFocusPoint.Temperature, Converter={StaticResource NaNToVisibilityCollapsedConverter}}">
                    <UniformGrid VerticalAlignment="Center" Columns="2">
                        <TextBlock Text="{ns:Loc LblTemperature}" />
                        <TextBlock
                            Margin="5,0,0,0"
                            VerticalAlignment="Center"
                            Text="{Binding LastAutoFocusPoint.Temperature, Converter={StaticResource UnitConverter}, ConverterParameter=' °C|2'}" />
                    </UniformGrid>
                </Border>
                <Border
                    Margin="0,5,0,0"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0"
                    Visibility="{Binding LastAutoFocusPoint.Filter, Converter={StaticResource NullOrEmptyStringToVisibilityCollapsedConverter}}">
                    <UniformGrid VerticalAlignment="Center" Columns="2">
                        <TextBlock Text="{ns:Loc LblFilter}" />
                        <TextBlock Margin="5,0,0,0" Text="{Binding LastAutoFocusPoint.Filter}" />
                    </UniformGrid>
                </Border>
            </StackPanel>
            <StackPanel Grid.Row="2" Orientation="Vertical">
                <UniformGrid
                    Margin="0,5,0,0"
                    VerticalAlignment="Center"
                    Columns="2">
                    <UniformGrid.Visibility>
                        <MultiBinding Converter="{StaticResource HF_AutoFocusFittingToVisibilityConverter}">
                            <Binding>
                                <Binding.Source>
                                    <s:String>QuadraticFitting</s:String>
                                </Binding.Source>
                            </Binding>
                            <Binding Path="AutoFocusChartMethod" />
                            <Binding Path="AutoFocusChartCurveFitting" />
                            <Binding Path="GaussianFitting" />
                            <Binding Path="HyperbolicFitting" />
                            <Binding Path="QuadraticFitting" />
                            <Binding Path="TrendlineFitting" />
                        </MultiBinding>
                    </UniformGrid.Visibility>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{ns:Loc LblParabolic}" />
                        <TextBlock Text=" R²" />
                    </StackPanel>
                    <TextBlock Margin="5,0,0,0" Text="{Binding QuadraticFitting.RSquared, StringFormat=\{0:0.00\}}" />
                </UniformGrid>
                <UniformGrid
                    Margin="0,5,0,0"
                    VerticalAlignment="Center"
                    Columns="2">
                    <UniformGrid.Visibility>
                        <MultiBinding Converter="{StaticResource HF_AutoFocusFittingToVisibilityConverter}">
                            <Binding>
                                <Binding.Source>
                                    <s:String>HyperbolicFitting</s:String>
                                </Binding.Source>
                            </Binding>
                            <Binding Path="AutoFocusChartMethod" />
                            <Binding Path="AutoFocusChartCurveFitting" />
                            <Binding Path="GaussianFitting" />
                            <Binding Path="HyperbolicFitting" />
                            <Binding Path="QuadraticFitting" />
                            <Binding Path="TrendlineFitting" />
                        </MultiBinding>
                    </UniformGrid.Visibility>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{ns:Loc LblHyperbolic}" />
                        <TextBlock Text=" R²" />
                    </StackPanel>
                    <TextBlock Margin="5,0,0,0" Text="{Binding HyperbolicFitting.RSquared, StringFormat=\{0:0.00\}}" />
                </UniformGrid>
                <UniformGrid
                    Margin="0,5,0,0"
                    VerticalAlignment="Center"
                    Columns="2">
                    <UniformGrid.Visibility>
                        <MultiBinding Converter="{StaticResource HF_AutoFocusFittingToVisibilityConverter}">
                            <Binding>
                                <Binding.Source>
                                    <s:String>Trendline</s:String>
                                </Binding.Source>
                            </Binding>
                            <Binding Path="AutoFocusChartMethod" />
                            <Binding Path="AutoFocusChartCurveFitting" />
                            <Binding Path="GaussianFitting" />
                            <Binding Path="HyperbolicFitting" />
                            <Binding Path="QuadraticFitting" />
                            <Binding Path="TrendlineFitting" />
                        </MultiBinding>
                    </UniformGrid.Visibility>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{ns:Loc LblTrendLines}" />
                        <TextBlock Text=" R²" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Margin="5,0,0,0" Text="{Binding TrendlineFitting.LeftTrend.RSquared, StringFormat=\{0:0.00\}}" />
                        <TextBlock Margin="5,0,0,0" Text="|" />
                        <TextBlock Margin="5,0,0,0" Text="{Binding TrendlineFitting.RightTrend.RSquared, StringFormat=\{0:0.00\}}" />
                    </StackPanel>
                </UniformGrid>
                <UniformGrid
                    Margin="0,5,0,0"
                    VerticalAlignment="Center"
                    Columns="2"
                    Visibility="{Binding AutoFocusDuration, Converter={StaticResource TimeSpanZeroToVisibilityConverter}}">
                    <TextBlock Text="{ns:Loc LblAutoFocusDuration}" />
                    <TextBlock Margin="5,0,0,0" Text="{Binding AutoFocusDuration, Converter={StaticResource TimeSpanToStringConverter}}" />
                </UniformGrid>
            </StackPanel>
            <ninactrl:CancellableButton
                Grid.Row="3"
                Height="25"
                Margin="10,15,0,5"
                Padding="5,0,5,0"
                HorizontalAlignment="Left"
                VerticalAlignment="Bottom"
                ButtonText="Reprocess Saved Run"
                CancelButtonImage="{StaticResource CancelSVG}"
                CancelCommand="{Binding CancelLoadSavedAutoFocusRunCommand}"
                CancelToolTip="{ns:Loc LblCancel}"
                Command="{Binding LoadSavedAutoFocusRunCommand}"
                IsEnabled="{Binding AutoFocusInProgress, Converter={StaticResource InverseBooleanConverter}}"
                ToolTip="Reprocesses AutoFocus images saved by having Save enabled in Hocus Focus -&gt; Auto Focus Options. This produces an auto focus curve using whatever the current star detection and fit settings are" />
        </Grid>
    </DataTemplate>
    <DataTemplate DataType="{x:Type local:HocusFocusVM}">
        <ContentControl Content="{Binding}" ContentTemplate="{StaticResource NINA.Joko.Plugins.HocusFocus.AutoFocus.HocusFocusVM_Dockable}" />
    </DataTemplate>
    <DataTemplate x:Key="NINA.Joko.Plugins.HocusFocus.StarDetection.StarDetectorDockable_Dockable">
        <ContentControl Content="{Binding StarDetectionOptions}" ContentTemplate="{StaticResource HocusFocus_StarDetection_Options}" />
    </DataTemplate>
    <DataTemplate x:Key="NINA.Joko.Plugins.HocusFocus.StarDetection.StarDetectionResultsVM_Dockable">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <Grid Margin="5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <StackPanel>
                    <StackPanel Margin="5" VerticalAlignment="Top">
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="{ns:Loc LblNrStars}" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Statistics.StarDetectionAnalysis.DetectedStars, StringFormat=\{0:0\}, Converter={StaticResource IntNegativeOneToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="{ns:Loc LblHFR}" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Statistics.StarDetectionAnalysis.HFR, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="{ns:Loc LblHFRStDev}" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Statistics.StarDetectionAnalysis.HFRStDev, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="PSF Type" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding PSFType, Converter={StaticResource HF_EnumStaticDescriptionValueConverter}}"
                                    Visibility="{Binding FWHM, Converter={StaticResource NaNToVisibilityConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="PSF R²" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding PSFRSquared, StringFormat=\{0:0.0000\}, Converter={StaticResource NaNToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="FWHM" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding FWHM, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="FWHM MAD" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding FWHMMAD, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="Eccentricity" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Eccentricity, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="Eccentricity MAD" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding EccentricityMAD, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="100"
                                    VerticalAlignment="Center"
                                    Text="Sigma" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Sigma, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                    </StackPanel>
                </StackPanel>
                <GroupBox Grid.Row="1" Header="Detection Metrics">
                    <StackPanel Margin="0,5,0,5" VerticalAlignment="Top">
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Total Detected" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.TotalDetected, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Structure Candidates" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.StructureCandidates, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Too Small" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.TooSmall, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="On Border" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.OnBorder, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Too Distorted" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.TooDistorted, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Degenerate" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.Degenerate, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Saturated" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.Saturated, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Low Sensitivity" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.LowSensitivity, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Not Centered" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.NotCentered, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Too Flat" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.TooFlat, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="HFR Too Low" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.TooLowHFR, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Failed Star Analysis" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.HFRAnalysisFailed, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                        <UniformGrid Columns="2">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="Outside ROI" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.OutsideROI, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="120"
                                    VerticalAlignment="Center"
                                    Text="PSF Failed" />
                                <TextBlock
                                    Width="70"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="{Binding Metrics.PSFFitFailed, Converter={StaticResource HF_ZeroToDoubleDashConverter}}" />
                            </StackPanel>
                        </UniformGrid>
                    </StackPanel>
                </GroupBox>
            </Grid>
        </ScrollViewer>
    </DataTemplate>
    <DataTemplate x:Key="NINA.Joko.Plugins.HocusFocus.AutoFocus.InspectorVM_Dockable">
        <ScrollViewer
            Name="SV"
            HorizontalScrollBarVisibility="Disabled"
            VerticalScrollBarVisibility="Auto">
            <ScrollViewer.Resources>
                <Style BasedOn="{StaticResource MyDataGridCell}" TargetType="{x:Type DataGridCell}">
                    <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                    <Setter Property="TextBlock.Margin" Value="1" />
                </Style>
                <Style BasedOn="{StaticResource StandardDataGridColumnHeader}" TargetType="{x:Type DataGridColumnHeader}">
                    <Setter Property="Padding" Value="3,2,3,2" />
                </Style>
            </ScrollViewer.Resources>
            <Grid>
                <Grid.RowDefinitions>
                    <!--  Buttons  -->
                    <RowDefinition Height="Auto" />
                    <!--  Options  -->
                    <RowDefinition Height="Auto" />
                    <!--  Show Sensor Model Toggle  -->
                    <RowDefinition Height="Auto" />
                    <!--  AF curves  -->
                    <RowDefinition Height="Auto" />
                    <!--  Sensor Curve Model  -->
                    <RowDefinition Height="Auto" />
                    <!--  Tilt measurements + Tilt graphic  -->
                    <RowDefinition Height="Auto" />
                    <!--  Tilt history  -->
                    <RowDefinition Height="Auto" />
                    <!--  Sensor Model Tilt measurements + Tilt graphic  -->
                    <RowDefinition Height="Auto" />
                    <!--  Sensor Model Tilt history  -->
                    <RowDefinition Height="Auto" />
                    <!--  FWHM contours  -->
                    <RowDefinition Height="Auto" />
                    <!--  Eccentricity field  -->
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!--  https://stackoverflow.com/a/61977964  -->
                <FrameworkElement x:Name="ShowSensorModel">
                    <FrameworkElement.Tag>
                        <MultiBinding Converter="{StaticResource BooleanAndConverter}">
                            <Binding Mode="OneWay" Path="InspectorOptions.SensorCurveModelEnabled" />
                            <Binding Mode="OneWay" Path="InspectorOptions.ShowSensorModel" />
                        </MultiBinding>
                    </FrameworkElement.Tag>
                </FrameworkElement>
                <FrameworkElement x:Name="ShowLoadedSensorModel">
                    <FrameworkElement.Tag>
                        <MultiBinding Converter="{StaticResource BooleanAndConverter}">
                            <Binding
                                ElementName="ShowSensorModel"
                                Mode="OneWay"
                                Path="Tag" />
                            <Binding Mode="OneWay" Path="SensorModel.ModelLoaded" />
                        </MultiBinding>
                    </FrameworkElement.Tag>
                </FrameworkElement>
                <FrameworkElement x:Name="ShowSensorModelTiltMeasurementActivatedOnce">
                    <FrameworkElement.Tag>
                        <MultiBinding Converter="{StaticResource BooleanAndConverter}">
                            <Binding
                                ElementName="ShowLoadedSensorModel"
                                Mode="OneWay"
                                Path="Tag" />
                            <Binding Mode="OneWay" Path="TiltMeasurementActivatedOnce" />
                        </MultiBinding>
                    </FrameworkElement.Tag>
                </FrameworkElement>
                <FrameworkElement x:Name="ShowAutoFocusTiltMeasurementActivatedOnce">
                    <FrameworkElement.Tag>
                        <MultiBinding Converter="{StaticResource BooleanAndConverter}">
                            <Binding
                                Converter="{StaticResource HF_InverseBooleanConverter}"
                                ElementName="ShowSensorModel"
                                Mode="OneWay"
                                Path="Tag" />
                            <Binding Mode="OneWay" Path="TiltMeasurementActivatedOnce" />
                        </MultiBinding>
                    </FrameworkElement.Tag>
                </FrameworkElement>

                <Grid Grid.Row="0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBlock
                        Grid.Row="0"
                        Grid.Column="0"
                        Margin="5"
                        VerticalAlignment="Center"
                        Text="Detailed Analysis"
                        ToolTip="{StaticResource DetailedAnalysis_Tooltip}" />
                    <ninactrl:CancellableButton
                        Grid.Row="0"
                        Grid.Column="1"
                        Height="30"
                        Margin="5"
                        Padding="10,5,10,5"
                        VerticalAlignment="Center"
                        Background="{StaticResource SecondaryBackgroundBrush}"
                        ButtonForegroundBrush="{StaticResource ButtonForegroundDisabledBrush}"
                        ButtonStyle="{StaticResource SecondaryBackgroundButton}"
                        ButtonText="Run Auto Focus"
                        CancelButtonImage="{StaticResource CancelSVG}"
                        CancelCommand="{Binding CancelAnalyzeCommand}"
                        CancelToolTip="Cancel the analysis in progress"
                        Command="{Binding RunAutoFocusAnalysisCommand}"
                        ToolTip="{StaticResource DetailedAnalysis_Tooltip}" />
                    <ninactrl:CancellableButton
                        Grid.Row="0"
                        Grid.Column="2"
                        Height="30"
                        Margin="5"
                        Padding="10,5,10,5"
                        VerticalAlignment="Center"
                        Background="{StaticResource SecondaryBackgroundBrush}"
                        ButtonForegroundBrush="{StaticResource ButtonForegroundDisabledBrush}"
                        ButtonStyle="{StaticResource SecondaryBackgroundButton}"
                        ButtonText="Load Saved AF"
                        CancelButtonImage="{StaticResource CancelSVG}"
                        CancelCommand="{Binding CancelAnalyzeCommand}"
                        CancelToolTip="Cancel the analysis in progress"
                        Command="{Binding RerunSavedAutoFocusAnalysisCommand}"
                        ToolTip="{StaticResource DetailedAnalysis_Tooltip}" />

                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="0"
                        Margin="5"
                        VerticalAlignment="Center"
                        Text="Simple Analysis"
                        ToolTip="{StaticResource SimpleAnalysis_Tooltip}" />
                    <ninactrl:CancellableButton
                        Grid.Row="1"
                        Grid.Column="1"
                        Height="30"
                        Margin="5"
                        Padding="10,5,10,5"
                        VerticalAlignment="Center"
                        Background="{StaticResource SecondaryBackgroundBrush}"
                        ButtonForegroundBrush="{StaticResource ButtonForegroundDisabledBrush}"
                        ButtonStyle="{StaticResource SecondaryBackgroundButton}"
                        ButtonText="Take Exposure"
                        CancelButtonImage="{StaticResource CancelSVG}"
                        CancelCommand="{Binding CancelAnalyzeCommand}"
                        CancelToolTip="Cancel the analysis in progress"
                        Command="{Binding RunExposureAnalysisCommand}"
                        ToolTip="{StaticResource SimpleAnalysis_Tooltip}" />
                    <StackPanel
                        Grid.Row="1"
                        Grid.Column="2"
                        Margin="5"
                        Orientation="Horizontal">
                        <ninactrl:HintTextBox
                            Grid.Row="1"
                            Grid.Column="2"
                            MinWidth="40"
                            VerticalAlignment="Center"
                            HorizontalContentAlignment="Left"
                            VerticalContentAlignment="Center"
                            Foreground="{StaticResource PrimaryBrush}"
                            HintText="(AutoFocus)"
                            TextAlignment="Left"
                            ToolTip="{StaticResource SimpleAnalysisExposureDuration_Tooltip}">
                            <ninactrl:HintTextBox.Text>
                                <Binding
                                    Converter="{StaticResource HF_DoubleNegativeToEmptyStringConverter}"
                                    Mode="TwoWay"
                                    Path="InspectorOptions.SimpleExposureSeconds"
                                    UpdateSourceTrigger="LostFocus" />
                            </ninactrl:HintTextBox.Text>
                        </ninactrl:HintTextBox>
                        <TextBlock
                            Margin="3,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Text="seconds"
                            ToolTip="{StaticResource SimpleAnalysisExposureDuration_Tooltip}" />
                    </StackPanel>
                    <StackPanel
                        Grid.Row="1"
                        Grid.Column="3"
                        Margin="5"
                        Orientation="Horizontal">
                        <TextBlock
                            VerticalAlignment="Center"
                            Text="Looping"
                            ToolTip="{StaticResource LoopingExposureAnalysis_Tooltip}" />
                        <CheckBox
                            Margin="5,0,0,0"
                            IsChecked="{Binding LoopingExposureAnalysis}"
                            IsEnabled="{Binding CameraInfo.Connected}" />
                    </StackPanel>

                    <TextBlock
                        Grid.Row="2"
                        Grid.Column="0"
                        Margin="5"
                        VerticalAlignment="Center"
                        Text="Slew to Zenith"
                        ToolTip="{StaticResource SlewToZenith_Tooltip}" />
                    <ninactrl:CancellableButton
                        Grid.Row="2"
                        Grid.Column="1"
                        Height="30"
                        Margin="5"
                        Padding="10,5,10,5"
                        VerticalAlignment="Center"
                        Background="{StaticResource SecondaryBackgroundBrush}"
                        ButtonForegroundBrush="{StaticResource ButtonForegroundDisabledBrush}"
                        ButtonStyle="{StaticResource SecondaryBackgroundButton}"
                        ButtonText="West"
                        CancelButtonImage="{StaticResource CancelSVG}"
                        CancelCommand="{Binding CancelSlewToZenithCommand}"
                        CancelToolTip="Cancel the slew in progress"
                        Command="{Binding SlewToZenithWestCommand}"
                        ToolTip="{StaticResource SlewToZenith_Tooltip}" />
                    <ninactrl:CancellableButton
                        Grid.Row="2"
                        Grid.Column="2"
                        Height="30"
                        Margin="5"
                        Padding="10,5,10,5"
                        VerticalAlignment="Center"
                        Background="{StaticResource SecondaryBackgroundBrush}"
                        ButtonForegroundBrush="{StaticResource ButtonForegroundDisabledBrush}"
                        ButtonStyle="{StaticResource SecondaryBackgroundButton}"
                        ButtonText="East"
                        CancelButtonImage="{StaticResource CancelSVG}"
                        CancelCommand="{Binding CancelSlewToZenithCommand}"
                        CancelToolTip="Cancel the slew in progress"
                        Command="{Binding SlewToZenithEastCommand}"
                        ToolTip="{StaticResource SlewToZenith_Tooltip}" />

                    <Button
                        Grid.Row="3"
                        Grid.Column="0"
                        Margin="5"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Command="{Binding ClearAnalysesCommand}"
                        ToolTip="{StaticResource ClearAnalyses_Tooltip}">
                        <Button.IsEnabled>
                            <MultiBinding Converter="{StaticResource BooleanOrConverter}">
                                <Binding Path="TiltMeasurementActivatedOnce" />
                                <Binding Path="ExposureAnalysisActivatedOnce" />
                            </MultiBinding>
                        </Button.IsEnabled>
                        <TextBlock
                            Margin="10,5,10,5"
                            Foreground="{StaticResource ButtonForegroundBrush}"
                            Text="Clear Analyses"
                            TextWrapping="Wrap" />
                    </Button>
                </Grid>
                <Expander
                    Grid.Row="1"
                    VerticalAlignment="Center"
                    Header="Options">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="Steps"
                            ToolTip="{StaticResource StepCount_Tooltip}" />
                        <ninactrl:HintTextBox
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="40"
                            VerticalAlignment="Center"
                            HorizontalContentAlignment="Left"
                            VerticalContentAlignment="Center"
                            Foreground="{StaticResource PrimaryBrush}"
                            HintText="(AutoFocus)"
                            TextAlignment="Left"
                            ToolTip="{StaticResource StepCount_Tooltip}">
                            <ninactrl:HintTextBox.Text>
                                <Binding
                                    Converter="{StaticResource HF_DoubleNegativeToEmptyStringConverter}"
                                    Mode="TwoWay"
                                    Path="InspectorOptions.StepCount"
                                    UpdateSourceTrigger="LostFocus" />
                            </ninactrl:HintTextBox.Text>
                        </ninactrl:HintTextBox>

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="Step Size"
                            ToolTip="{StaticResource StepSize_Tooltip}" />
                        <ninactrl:HintTextBox
                            Grid.Row="1"
                            Grid.Column="1"
                            MinWidth="40"
                            VerticalAlignment="Center"
                            HorizontalContentAlignment="Left"
                            VerticalContentAlignment="Center"
                            Foreground="{StaticResource PrimaryBrush}"
                            HintText="(AutoFocus)"
                            TextAlignment="Left"
                            ToolTip="{StaticResource StepSize_Tooltip}">
                            <ninactrl:HintTextBox.Text>
                                <Binding
                                    Converter="{StaticResource HF_DoubleNegativeToEmptyStringConverter}"
                                    Mode="TwoWay"
                                    Path="InspectorOptions.StepSize"
                                    UpdateSourceTrigger="LostFocus" />
                            </ninactrl:HintTextBox.Text>
                        </ninactrl:HintTextBox>

                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="0"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="Exposures per Point"
                            ToolTip="{StaticResource FramesPerPoint_Tooltip}" />
                        <ninactrl:HintTextBox
                            Grid.Row="2"
                            Grid.Column="1"
                            MinWidth="40"
                            VerticalAlignment="Center"
                            HorizontalContentAlignment="Left"
                            VerticalContentAlignment="Center"
                            Foreground="{StaticResource PrimaryBrush}"
                            HintText="(AutoFocus)"
                            TextAlignment="Left"
                            ToolTip="{StaticResource FramesPerPoint_Tooltip}">
                            <ninactrl:HintTextBox.Text>
                                <Binding
                                    Converter="{StaticResource HF_DoubleNegativeToEmptyStringConverter}"
                                    Mode="TwoWay"
                                    Path="InspectorOptions.FramesPerPoint"
                                    UpdateSourceTrigger="LostFocus" />
                            </ninactrl:HintTextBox.Text>
                        </ninactrl:HintTextBox>

                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="0"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="AutoFocus Timeout"
                            ToolTip="{StaticResource AutoFocusTimeoutSeconds_Tooltip}" />
                        <StackPanel
                            Grid.Row="3"
                            Grid.Column="1"
                            Orientation="Horizontal">
                            <ninactrl:HintTextBox
                                MinWidth="40"
                                VerticalAlignment="Center"
                                HorizontalContentAlignment="Left"
                                VerticalContentAlignment="Center"
                                Foreground="{StaticResource PrimaryBrush}"
                                HintText="(AutoFocus)"
                                TextAlignment="Left"
                                ToolTip="{StaticResource AutoFocusTimeoutSeconds_Tooltip}">
                                <ninactrl:HintTextBox.Text>
                                    <Binding
                                        Converter="{StaticResource HF_DoubleNegativeToEmptyStringConverter}"
                                        Mode="TwoWay"
                                        Path="InspectorOptions.TimeoutSeconds"
                                        UpdateSourceTrigger="LostFocus" />
                                </ninactrl:HintTextBox.Text>
                            </ninactrl:HintTextBox>
                            <TextBlock
                                Margin="3,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Text="seconds"
                                ToolTip="{StaticResource AutoFocusTimeoutSeconds_Tooltip}" />
                        </StackPanel>

                        <TextBlock
                            Grid.Row="4"
                            Grid.Column="0"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="Eccentricity Grid Width"
                            ToolTip="{StaticResource NumRegionsWide_Tooltip}" />
                        <ninactrl:UnitTextBox
                            Grid.Row="4"
                            Grid.Column="1"
                            MinWidth="40"
                            VerticalAlignment="Center"
                            HorizontalContentAlignment="Left"
                            VerticalContentAlignment="Center"
                            Foreground="{StaticResource PrimaryBrush}"
                            TextAlignment="Left"
                            ToolTip="{StaticResource NumRegionsWide_Tooltip}"
                            Unit="cells">
                            <Binding
                                Converter="{StaticResource HF_ZeroToInfinityConverter}"
                                Path="InspectorOptions.NumRegionsWide"
                                UpdateSourceTrigger="LostFocus">
                                <Binding.ValidationRules>
                                    <hfrules:PositiveOddIntegerRule />
                                </Binding.ValidationRules>
                            </Binding>
                        </ninactrl:UnitTextBox>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="2"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="Focuser Step Size"
                            ToolTip="{StaticResource MicronsPerFocuserStep_Tooltip}" />
                        <StackPanel
                            Grid.Row="0"
                            Grid.Column="3"
                            Orientation="Horizontal">
                            <ninactrl:HintTextBox
                                MinWidth="40"
                                VerticalAlignment="Center"
                                HorizontalContentAlignment="Left"
                                VerticalContentAlignment="Center"
                                Foreground="{StaticResource PrimaryBrush}"
                                HintText="(disabled)"
                                TextAlignment="Left"
                                ToolTip="{StaticResource MicronsPerFocuserStep_Tooltip}">
                                <ninactrl:HintTextBox.Text>
                                    <Binding
                                        Converter="{StaticResource HF_DoubleNegativeToEmptyStringConverter}"
                                        Mode="TwoWay"
                                        Path="InspectorOptions.MicronsPerFocuserStep"
                                        UpdateSourceTrigger="LostFocus" />
                                </ninactrl:HintTextBox.Text>
                            </ninactrl:HintTextBox>
                            <TextBlock
                                Margin="3,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Text="microns"
                                ToolTip="{StaticResource MicronsPerFocuserStep_Tooltip}" />
                        </StackPanel>

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="2"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="Eccentricity Color Enabled"
                            ToolTip="{StaticResource EccentricityColorMapEnabled_Tooltip}" />
                        <StackPanel
                            Grid.Row="1"
                            Grid.Column="3"
                            Orientation="Horizontal">
                            <CheckBox Margin="5,0,0,0" IsChecked="{Binding InspectorOptions.EccentricityColorMapEnabled}" />
                        </StackPanel>

                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="2"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="Mouse Events Enabled"
                            ToolTip="{StaticResource MouseOnChartsEnabled_Tooltip}" />
                        <StackPanel
                            Grid.Row="2"
                            Grid.Column="3"
                            Orientation="Horizontal">
                            <CheckBox Margin="5,0,0,0" IsChecked="{Binding InspectorOptions.MouseOnChartsEnabled}" />
                        </StackPanel>

                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="2"
                            Margin="5"
                            VerticalAlignment="Center"
                            Text="Sensor Curve Model Enabled"
                            ToolTip="{StaticResource SensorCurveModelEnabled_Tooltip}" />
                        <StackPanel
                            Grid.Row="3"
                            Grid.Column="3"
                            Orientation="Horizontal">
                            <CheckBox Margin="5,0,0,0" IsChecked="{Binding InspectorOptions.SensorCurveModelEnabled}" />
                        </StackPanel>
                    </Grid>
                </Expander>
                <StackPanel
                    Grid.Row="2"
                    Margin="5"
                    Orientation="Horizontal"
                    Visibility="{Binding InspectorOptions.SensorCurveModelEnabled, Mode=OneWay, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <TextBlock VerticalAlignment="Center" Text="Show Sensor Model" />
                    <CheckBox Margin="5,0,0,0" IsChecked="{Binding InspectorOptions.ShowSensorModel}" />
                </StackPanel>
                <Expander
                    Grid.Row="3"
                    Header="Focus Chart"
                    IsExpanded="{Binding AutoFocusChartActive}"
                    Visibility="{Binding AutoFocusChartActivatedOnce, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <Grid>
                        <Grid.Resources>
                            <Style x:Key="ShowOnAutoFocusComplete" TargetType="{x:Type RowDefinition}">
                                <Setter Property="Height" Value="0" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding AutoFocusCompleted}" Value="True">
                                        <Setter Property="Height" Value="Auto" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                            <SolidColorBrush x:Key="TopLeftBrush">
                                <SolidColorBrush.Color>
                                    <MultiBinding Converter="{StaticResource HF_InterpolateColorConverter}">
                                        <Binding Path="Color" Source="{StaticResource SecondaryBrush}" />
                                        <Binding Path="Color" Source="{StaticResource BackgroundBrush}" />
                                        <Binding>
                                            <Binding.Source>
                                                <s:Int32>0</s:Int32>
                                            </Binding.Source>
                                        </Binding>
                                        <Binding>
                                            <Binding.Source>
                                                <s:Int32>4</s:Int32>
                                            </Binding.Source>
                                        </Binding>
                                    </MultiBinding>
                                </SolidColorBrush.Color>
                            </SolidColorBrush>
                            <SolidColorBrush x:Key="TopRightBrush">
                                <SolidColorBrush.Color>
                                    <MultiBinding Converter="{StaticResource HF_InterpolateColorConverter}">
                                        <Binding Path="Color" Source="{StaticResource SecondaryBrush}" />
                                        <Binding Path="Color" Source="{StaticResource BackgroundBrush}" />
                                        <Binding>
                                            <Binding.Source>
                                                <s:Int32>1</s:Int32>
                                            </Binding.Source>
                                        </Binding>
                                        <Binding>
                                            <Binding.Source>
                                                <s:Int32>4</s:Int32>
                                            </Binding.Source>
                                        </Binding>
                                    </MultiBinding>
                                </SolidColorBrush.Color>
                            </SolidColorBrush>
                            <SolidColorBrush x:Key="BottomLeftBrush">
                                <SolidColorBrush.Color>
                                    <MultiBinding Converter="{StaticResource HF_InterpolateColorConverter}">
                                        <Binding Path="Color" Source="{StaticResource SecondaryBrush}" />
                                        <Binding Path="Color" Source="{StaticResource BackgroundBrush}" />
                                        <Binding>
                                            <Binding.Source>
                                                <s:Int32>2</s:Int32>
                                            </Binding.Source>
                                        </Binding>
                                        <Binding>
                                            <Binding.Source>
                                                <s:Int32>4</s:Int32>
                                            </Binding.Source>
                                        </Binding>
                                    </MultiBinding>
                                </SolidColorBrush.Color>
                            </SolidColorBrush>
                            <SolidColorBrush x:Key="BottomRightBrush">
                                <SolidColorBrush.Color>
                                    <MultiBinding Converter="{StaticResource HF_InterpolateColorConverter}">
                                        <Binding Path="Color" Source="{StaticResource SecondaryBrush}" />
                                        <Binding Path="Color" Source="{StaticResource BackgroundBrush}" />
                                        <Binding>
                                            <Binding.Source>
                                                <s:Int32>3</s:Int32>
                                            </Binding.Source>
                                        </Binding>
                                        <Binding>
                                            <Binding.Source>
                                                <s:Int32>4</s:Int32>
                                            </Binding.Source>
                                        </Binding>
                                    </MultiBinding>
                                </SolidColorBrush.Color>
                            </SolidColorBrush>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Style="{StaticResource ShowOnAutoFocusComplete}" />
                            <RowDefinition Style="{StaticResource ShowOnAutoFocusComplete}" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Row="0"
                            Margin="10"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontWeight="DemiBold"
                            Text="Auto Focus for Corners vs Center" />
                        <controls:OxyPlotExtended
                            Grid.Row="1"
                            MinWidth="400"
                            MinHeight="400"
                            Background="{StaticResource BackgroundBrush}"
                            IsLegendVisible="True"
                            LegendOrientation="Vertical"
                            LegendPlacement="Inside"
                            LegendPosition="RightBottom"
                            MouseDoubleClick="Plot_MouseDoubleClick"
                            PlotAreaBackground="{StaticResource BackgroundBrush}"
                            PlotAreaBorderColor="{Binding Path=Color, Source={StaticResource BorderBrush}}"
                            PlotModel="{Binding AutoFocusChartPlotModel, Mode=OneWayToSource, NotifyOnTargetUpdated=True}"
                            TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}">
                            <oxy:Plot.Axes>
                                <oxy:LinearAxis
                                    AxislineColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                                    EndPosition="1"
                                    IsPanEnabled="{Binding Path=InspectorOptions.MouseOnChartsEnabled}"
                                    IsZoomEnabled="{Binding Path=InspectorOptions.MouseOnChartsEnabled}"
                                    MajorGridlineColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}, Converter={StaticResource SetAlphaToColorConverter}, ConverterParameter=60}"
                                    MajorGridlineStyle="LongDash"
                                    MaximumPadding="0.1"
                                    MinimumPadding="0.1"
                                    Position="Left"
                                    StartPosition="0"
                                    TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                                    TicklineColor="{Binding Path=Color, Source={StaticResource SecondaryBrush}}" />

                                <oxy:LinearAxis
                                    AxislineColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                                    EndPosition="1"
                                    IsPanEnabled="{Binding Path=InspectorOptions.MouseOnChartsEnabled}"
                                    IsZoomEnabled="{Binding Path=InspectorOptions.MouseOnChartsEnabled}"
                                    MajorGridlineColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}, Converter={StaticResource SetAlphaToColorConverter}, ConverterParameter=60}"
                                    MajorGridlineStyle="LongDash"
                                    MaximumPadding="0.1"
                                    MinimumPadding="0.1"
                                    Position="Bottom"
                                    StartPosition="0"
                                    TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                                    TicklineColor="{Binding Path=Color, Source={StaticResource SecondaryBrush}}" />
                            </oxy:Plot.Axes>
                            <oxy:Plot.Series>
                                <oxy:ScatterErrorSeries
                                    Name="CenterFocusPoints"
                                    Title="Center"
                                    DataFieldX="FocusPosition"
                                    DataFieldY="HFR"
                                    ErrorBarColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                                    ErrorBarStopWidth="2"
                                    ErrorBarStrokeThickness="2"
                                    ItemsSource="{Binding RegionFocusPoints[1]}"
                                    MarkerFill="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                                    MarkerSize="3"
                                    MarkerType="Circle"
                                    Color="{Binding Path=Color, Source={StaticResource PrimaryBrush}}" />
                                <oxy:ScatterErrorSeries
                                    Name="TopLeftFocusPoints"
                                    Title="Top Left"
                                    DataFieldX="FocusPosition"
                                    DataFieldY="HFR"
                                    ErrorBarColor="{Binding Path=Color, Source={StaticResource TopLeftBrush}}"
                                    ErrorBarStopWidth="1"
                                    ErrorBarStrokeThickness="1"
                                    ItemsSource="{Binding RegionFocusPoints[2]}"
                                    MarkerFill="{Binding Path=Color, Source={StaticResource TopLeftBrush}}"
                                    MarkerSize="3"
                                    MarkerType="Circle"
                                    Color="{Binding Path=Color, Source={StaticResource TopLeftBrush}}" />
                                <oxy:ScatterErrorSeries
                                    Name="TopRightFocusPoints"
                                    Title="Top Right"
                                    DataFieldX="FocusPosition"
                                    DataFieldY="HFR"
                                    ErrorBarColor="{Binding Path=Color, Source={StaticResource TopRightBrush}}"
                                    ErrorBarStopWidth="1"
                                    ErrorBarStrokeThickness="1"
                                    ItemsSource="{Binding RegionFocusPoints[3]}"
                                    MarkerFill="{Binding Path=Color, Source={StaticResource TopRightBrush}}"
                                    MarkerSize="3"
                                    MarkerType="Circle"
                                    Color="{Binding Path=Color, Source={StaticResource TopRightBrush}}" />
                                <oxy:ScatterErrorSeries
                                    Name="BottomLeftFocusPoints"
                                    Title="Bottom Left"
                                    DataFieldX="FocusPosition"
                                    DataFieldY="HFR"
                                    ErrorBarColor="{Binding Path=Color, Source={StaticResource BottomLeftBrush}}"
                                    ErrorBarStopWidth="1"
                                    ErrorBarStrokeThickness="1"
                                    ItemsSource="{Binding RegionFocusPoints[4]}"
                                    MarkerFill="{Binding Path=Color, Source={StaticResource BottomLeftBrush}}"
                                    MarkerSize="3"
                                    MarkerType="Circle"
                                    Color="{Binding Path=Color, Source={StaticResource BottomLeftBrush}}" />
                                <oxy:ScatterErrorSeries
                                    Name="BottomRightFocusPoints"
                                    Title="Bottom Right"
                                    DataFieldX="FocusPosition"
                                    DataFieldY="HFR"
                                    ErrorBarColor="{Binding Path=Color, Source={StaticResource BottomRightBrush}}"
                                    ErrorBarStopWidth="1"
                                    ErrorBarStrokeThickness="1"
                                    ItemsSource="{Binding RegionFocusPoints[5]}"
                                    MarkerFill="{Binding Path=Color, Source={StaticResource BottomRightBrush}}"
                                    MarkerSize="3"
                                    MarkerType="Circle"
                                    Color="{Binding Path=Color, Source={StaticResource BottomRightBrush}}" />
                            </oxy:Plot.Series>
                            <oxy:Plot.Annotations>
                                <oxy:FunctionAnnotation
                                    Name="CenterCurveFitting"
                                    Equation="{Binding RegionCurveFittings[1]}"
                                    LineStyle="LongDash"
                                    Visibility="{Binding RegionCurveFittings[1], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource PrimaryBrush}}" />
                                <oxy:LineAnnotation
                                    Name="CenterLeftLineFitting"
                                    Intercept="{Binding RegionLineFittings[1].LeftTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[1].LeftTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[1], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource PrimaryBrush}}" />
                                <oxy:LineAnnotation
                                    Name="CenterRightLineFitting"
                                    Intercept="{Binding RegionLineFittings[1].RightTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[1].RightTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[1], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource PrimaryBrush}}" />

                                <oxy:FunctionAnnotation
                                    Name="TopLeftCurveFitting"
                                    Equation="{Binding RegionCurveFittings[2]}"
                                    Visibility="{Binding RegionCurveFittings[2], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource TopLeftBrush}}" />
                                <oxy:LineAnnotation
                                    Name="TopLeftLeftLineFitting"
                                    Intercept="{Binding RegionLineFittings[2].LeftTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[2].LeftTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[2], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource TopLeftBrush}}" />
                                <oxy:LineAnnotation
                                    Name="TopLeftRightLineFitting"
                                    Intercept="{Binding RegionLineFittings[2].RightTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[2].RightTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[2], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource TopLeftBrush}}" />

                                <oxy:FunctionAnnotation
                                    Name="TopRightCurveFitting"
                                    Equation="{Binding RegionCurveFittings[3]}"
                                    Visibility="{Binding RegionCurveFittings[3], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource TopRightBrush}}" />
                                <oxy:LineAnnotation
                                    Name="TopRightLeftLineFitting"
                                    Intercept="{Binding RegionLineFittings[3].LeftTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[3].LeftTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[3], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource TopRightBrush}}" />
                                <oxy:LineAnnotation
                                    Name="TopRightRightLineFitting"
                                    Intercept="{Binding RegionLineFittings[3].RightTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[3].RightTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[3], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource TopRightBrush}}" />

                                <oxy:FunctionAnnotation
                                    Name="BottomLeftCurveFitting"
                                    Equation="{Binding RegionCurveFittings[4]}"
                                    Visibility="{Binding RegionCurveFittings[4], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource BottomLeftBrush}}" />
                                <oxy:LineAnnotation
                                    Name="BottomLeftLeftLineFitting"
                                    Intercept="{Binding RegionLineFittings[4].LeftTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[4].LeftTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[4], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource BottomLeftBrush}}" />
                                <oxy:LineAnnotation
                                    Name="BottomLeftRightLineFitting"
                                    Intercept="{Binding RegionLineFittings[4].RightTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[4].RightTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[4], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource BottomLeftBrush}}" />

                                <oxy:FunctionAnnotation
                                    Name="BottomRightCurveFitting"
                                    Equation="{Binding RegionCurveFittings[5]}"
                                    Visibility="{Binding RegionCurveFittings[5], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource BottomRightBrush}}" />
                                <oxy:LineAnnotation
                                    Name="BottomRightLeftLineFitting"
                                    Intercept="{Binding RegionLineFittings[5].LeftTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[5].LeftTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[5], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource BottomRightBrush}}" />
                                <oxy:LineAnnotation
                                    Name="BottomRightRightLineFitting"
                                    Intercept="{Binding RegionLineFittings[5].RightTrend.Offset}"
                                    Slope="{Binding RegionLineFittings[5].RightTrend.Slope}"
                                    Visibility="{Binding RegionLineFittings[5], Converter={StaticResource NullToVisibilityCollapsedConverter}}"
                                    Color="{Binding Path=Color, Source={StaticResource BottomRightBrush}}" />

                                <oxy:PointAnnotation
                                    Name="CenterFinalFocusPoint"
                                    Fill="{Binding Path=Color, Source={StaticResource AltPrimaryBrush}}"
                                    Shape="Diamond"
                                    Stroke="{Binding Path=Color, Source={StaticResource AltPrimaryBrush}}"
                                    Visibility="{Binding RegionFinalFocusPoints[1].X, Converter={StaticResource HF_DoubleNegativeToVisibilityConverter}}"
                                    X="{Binding RegionFinalFocusPoints[1].X}"
                                    Y="{Binding RegionFinalFocusPoints[1].Y}" />

                                <oxy:PointAnnotation
                                    Name="TopLeftFinalFocusPoint"
                                    Fill="{Binding Path=Color, Source={StaticResource TopLeftBrush}}"
                                    Shape="Cross"
                                    Stroke="{Binding Path=Color, Source={StaticResource TopLeftBrush}}"
                                    StrokeThickness="1"
                                    Visibility="{Binding RegionFinalFocusPoints[2].X, Converter={StaticResource HF_DoubleNegativeToVisibilityConverter}}"
                                    X="{Binding RegionFinalFocusPoints[2].X}"
                                    Y="{Binding RegionFinalFocusPoints[2].Y}" />

                                <oxy:PointAnnotation
                                    Name="TopRightFinalFocusPoint"
                                    Fill="{Binding Path=Color, Source={StaticResource TopRightBrush}}"
                                    Shape="Cross"
                                    Stroke="{Binding Path=Color, Source={StaticResource TopRightBrush}}"
                                    StrokeThickness="1"
                                    Visibility="{Binding RegionFinalFocusPoints[3].X, Converter={StaticResource HF_DoubleNegativeToVisibilityConverter}}"
                                    X="{Binding RegionFinalFocusPoints[3].X}"
                                    Y="{Binding RegionFinalFocusPoints[3].Y}" />

                                <oxy:PointAnnotation
                                    Name="BottomLeftFinalFocusPoint"
                                    Fill="{Binding Path=Color, Source={StaticResource BottomLeftBrush}}"
                                    Shape="Cross"
                                    Stroke="{Binding Path=Color, Source={StaticResource BottomLeftBrush}}"
                                    StrokeThickness="1"
                                    Visibility="{Binding RegionFinalFocusPoints[4].X, Converter={StaticResource HF_DoubleNegativeToVisibilityConverter}}"
                                    X="{Binding RegionFinalFocusPoints[4].X}"
                                    Y="{Binding RegionFinalFocusPoints[4].Y}" />

                                <oxy:PointAnnotation
                                    Name="BottomRightFinalFocusPoint"
                                    Fill="{Binding Path=Color, Source={StaticResource BottomRightBrush}}"
                                    Shape="Cross"
                                    Stroke="{Binding Path=Color, Source={StaticResource BottomRightBrush}}"
                                    StrokeThickness="1"
                                    Visibility="{Binding RegionFinalFocusPoints[5].X, Converter={StaticResource HF_DoubleNegativeToVisibilityConverter}}"
                                    X="{Binding RegionFinalFocusPoints[5].X}"
                                    Y="{Binding RegionFinalFocusPoints[5].Y}" />
                            </oxy:Plot.Annotations>
                        </controls:OxyPlotExtended>
                        <StackPanel
                            Grid.Row="2"
                            HorizontalAlignment="Center"
                            Orientation="Vertical"
                            Visibility="{Binding Path=Tag, ElementName=ShowLoadedSensorModel, Mode=OneWay, Converter={StaticResource InverseBooleanToVisibilityCollapsedConverter}}">
                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                <TextBlock Text="Backfocus Error: " />
                                <StackPanel Orientation="Horizontal" Visibility="{Binding BackfocusMicronDelta, Converter={StaticResource HF_InverseNaNToVisibilityCollapsedConverter}}">
                                    <TextBlock Text="{Binding BackfocusFocuserPositionDelta, StringFormat=\{0:0\}}" />
                                    <TextBlock Text=" steps" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Visibility="{Binding BackfocusMicronDelta, Converter={StaticResource NaNToVisibilityCollapsedConverter}}">
                                    <TextBlock Text="{Binding BackfocusMicronDelta, StringFormat=\{0:0\}}" />
                                    <TextBlock Text=" microns" />
                                </StackPanel>
                                <TextBlock Text=" (Move sensor " />
                                <TextBlock FontWeight="DemiBold" Text="{Binding BackfocusDirection}" />
                                <TextBlock Text=" flattener)" />
                            </StackPanel>
                        </StackPanel>
                        <StackPanel
                            Grid.Row="3"
                            HorizontalAlignment="Center"
                            Orientation="Vertical"
                            Visibility="{Binding Path=Tag, ElementName=ShowLoadedSensorModel, Mode=OneWay, Converter={StaticResource InverseBooleanToVisibilityCollapsedConverter}}">
                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                <TextBlock Text="HFR difference: " />
                                <TextBlock Text="{Binding BackfocusHFR, StringFormat=\{0:0.##\}}" />
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Inner: " />
                                    <TextBlock Text="{Binding InnerHFR, StringFormat=\{0:0.##\}}" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text=", Outer: " />
                                    <TextBlock Text="{Binding OuterHFR, StringFormat=\{0:0.##\}}" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Expander>
                <Expander
                    Grid.Row="4"
                    Header="Sensor Curve Model"
                    IsExpanded="{Binding SensorCurveModelActive}"
                    Visibility="{Binding Path=Tag, ElementName=ShowLoadedSensorModel, Mode=OneWay, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="400" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="10,5,0,5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="400" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontStyle="Italic"
                                Text="Deep red indicates elevation difference exceeding critical focus" />
                            <TextBlock
                                Grid.Row="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontStyle="Italic"
                                Text="Telescope is up, Sensor is down" />
                            <controls:SensorModelContourMapControl
                                Grid.Row="2"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                AxisColor="{Binding Path=Color, Source={StaticResource BorderBrush}}"
                                FRatio="{Binding SensorModel.SensorModelResult.FRatio, Mode=OneWay}"
                                ImageSize="{Binding SensorModel.SensorModelResult.ImageSize, Mode=OneWay}"
                                PixelSize="{Binding SensorModel.SensorModelResult.PixelSizeMicrons, Mode=OneWay}"
                                PlotBackgroundColor="{Binding Path=Color, Source={StaticResource BackgroundBrush}}"
                                SensorMeanElevation="{Binding SensorModel.SensorModelResult.SensorMeanElevation, Mode=OneWay}"
                                SensorModel="{Binding SensorModel.SensorModelResult.Model, Mode=OneWay}"
                                SurfaceColor="{Binding Path=Color, Source={StaticResource ButtonForegroundDisabledBrush}, Converter={StaticResource SetAlphaToColorConverter}, ConverterParameter=80}"
                                SurfaceHighExtremeColor="Blue"
                                SurfaceLowExtremeColor="Red"
                                TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}" />
                        </Grid>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="1"
                            Margin="10,0,10,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontWeight="DemiBold"
                            Text="Model Properties" />
                        <Grid
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="10,5,10,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Stars in Model"
                                ToolTip="{StaticResource SensorModel_StarsInModel_Tooltip}" />
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="{Binding SensorModel.SensorModelResult.Model.StarsInModel, Mode=OneWay}"
                                ToolTip="{StaticResource SensorModel_StarsInModel_Tooltip}" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Model R²" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="{Binding SensorModel.SensorModelResult.Model.GoodnessOfFit, StringFormat=\{0:0.00\}, Mode=OneWay}" />
                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Model RMS" />
                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center">
                                <Run Text="{Binding SensorModel.SensorModelResult.Model.RMSErrorMicrons, StringFormat=\{0:0.0\}, Mode=OneWay}" /> <Run Text="microns" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Tilt"
                                ToolTip="{StaticResource SensorModel_Tilt_Tooltip}" />
                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                ToolTip="{StaticResource SensorModel_Tilt_Tooltip}">
                                <Run Text="{Binding SensorModel.SensorModelResult.Tilt.Degree, StringFormat=\{0:0.000\}, Mode=OneWay}" /><Run Text="°" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Curvature Radius"
                                ToolTip="{StaticResource SensorModel_CurvatureRadius_Tooltip}" />
                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                ToolTip="{StaticResource SensorModel_CurvatureRadius_Tooltip}">
                                <Run Text="{Binding SensorModel.SensorModelResult.CurvatureRadiusMillimeters, StringFormat=\{0:0.\}, Mode=OneWay}" /> <Run Text="mm" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="5"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Curvature Effect"
                                ToolTip="{StaticResource SensorModel_CurvatureEffect_Tooltip}" />
                            <TextBlock
                                Grid.Row="5"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                ToolTip="{StaticResource SensorModel_CurvatureEffect_Tooltip}">
                                <Run Text="{Binding SensorModel.SensorModelResult.CurvatureEffectMicrons, StringFormat=\{0:0.\}, Mode=OneWay}" /> <Run Text="microns" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="6"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Tilt Effect"
                                ToolTip="{StaticResource SensorModel_TiltEffect_Tooltip}" />
                            <TextBlock
                                Grid.Row="6"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                ToolTip="{StaticResource SensorModel_TiltEffect_Tooltip}">
                                <Run Text="{Binding SensorModel.SensorModelResult.TiltEffectMicrons, StringFormat=\{0:0.\}, Mode=OneWay}" /> <Run Text="microns" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="7"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Mean Focuser Position"
                                ToolTip="{StaticResource SensorModel_MeanFocuserPosition_Tooltip}" />
                            <TextBlock
                                Grid.Row="7"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                ToolTip="{StaticResource SensorModel_MeanFocuserPosition_Tooltip}">
                                <Run Text="{Binding SensorModel.SensorModelResult.SensorMeanPosition, StringFormat=\{0:0.\}, Mode=OneWay}" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="8"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Auto Focus Offset"
                                ToolTip="{StaticResource SensorModel_AutoFocusOffset_Tooltip}" />
                            <TextBlock
                                Grid.Row="8"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                ToolTip="{StaticResource SensorModel_AutoFocusOffset_Tooltip}">
                                <Run Text="{Binding SensorModel.SensorModelResult.AutoFocusMeanOffset, StringFormat=\{0:0.\}, Mode=OneWay}" /> <Run Text="steps" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="9"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Pixel Size" />
                            <TextBlock
                                Grid.Row="9"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center">
                                <Run Text="{Binding SensorModel.SensorModelResult.PixelSizeMicrons, StringFormat=\{0:0.00\}, Mode=OneWay}" /> <Run Text="microns" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="10"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Focuser Step Size" />
                            <TextBlock
                                Grid.Row="10"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center">
                                <Run Text="{Binding SensorModel.SensorModelResult.FocuserStepSizeMicrons, StringFormat=\{0:0.00\}, Mode=OneWay}" /> <Run Text="microns" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="11"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="F/Ratio" />
                            <TextBlock
                                Grid.Row="11"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="{Binding SensorModel.SensorModelResult.FRatio, StringFormat=\{0:0.0\}, Mode=OneWay}" />
                            <TextBlock
                                Grid.Row="12"
                                Grid.Column="0"
                                Margin="5"
                                VerticalAlignment="Center"
                                Text="Critical Focus"
                                ToolTip="{StaticResource SensorModel_CriticalFocus_Tooltip}" />
                            <TextBlock
                                Grid.Row="12"
                                Grid.Column="1"
                                Margin="5"
                                VerticalAlignment="Center"
                                ToolTip="{StaticResource SensorModel_CriticalFocus_Tooltip}">
                                <Run Text="{Binding SensorModel.SensorModelResult.CriticalFocusMicrons, StringFormat=\{0:0.0\}, Mode=OneWay}" /> <Run Text="microns" />
                            </TextBlock>
                        </Grid>
                        <Grid
                            Grid.Row="2"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            HorizontalAlignment="Center">
                            <Grid.Resources>
                                <DataTemplate x:Key="AnalysisResultAcceptableTemplate">
                                    <CheckBox
                                        Width="20"
                                        Height="20"
                                        Margin="5,0,0,0"
                                        HorizontalAlignment="Center"
                                        BorderBrush="Transparent"
                                        IsChecked="{Binding Acceptable, FallbackValue=False, Mode=OneWay}"
                                        IsEnabled="False"
                                        Style="{StaticResource CheckmarkCheckbox}" />
                                </DataTemplate>
                            </Grid.Resources>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                Margin="10,5,10,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontWeight="DemiBold"
                                Text="Model Analysis" />
                            <DataGrid
                                Grid.Row="1"
                                Margin="10,5,10,0"
                                HorizontalAlignment="Center"
                                AutoGenerateColumns="False"
                                ColumnWidth="Auto"
                                IsReadOnly="True"
                                ItemsSource="{Binding SensorModel.SensorModelResult.AnalysisResults}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn
                                        Width="Auto"
                                        Binding="{Binding Name, Mode=OneWay}"
                                        Header="Check" />
                                    <DataGridTextColumn
                                        Width="Auto"
                                        Binding="{Binding Value, Mode=OneWay}"
                                        Header="Value" />
                                    <DataGridTemplateColumn CellTemplate="{StaticResource AnalysisResultAcceptableTemplate}" Header="OK" />
                                    <DataGridTextColumn
                                        Width="Auto"
                                        Binding="{Binding Details, Mode=OneWay}"
                                        Header="Details" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Grid>
                </Expander>

                <Expander
                    Grid.Row="5"
                    Header="Tilt Measurement"
                    IsExpanded="{Binding TiltMeasurementActive}"
                    Visibility="{Binding ElementName=ShowAutoFocusTiltMeasurementActivatedOnce, Path=Tag, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <Grid HorizontalAlignment="Stretch">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0" HorizontalAlignment="Center">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                Margin="10"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontWeight="DemiBold"
                                Text="Tilt Corner Measurements" />
                            <DataGrid
                                Grid.Row="1"
                                Margin="10"
                                HorizontalAlignment="Center"
                                AutoGenerateColumns="False"
                                ColumnWidth="Auto"
                                IsReadOnly="True"
                                ItemsSource="{Binding TiltModel.SensorTiltModels}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding SensorSide, Converter={StaticResource HF_EnumStaticDescriptionValueConverter}}"
                                        Header="Side" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding FocuserPosition, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                        Header="Position" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                        Header="Adj Steps" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding AdjustmentRequiredMicrons, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                        Header="Adj Microns" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding RSquared, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                        Header="R²" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                        <Grid Grid.Column="1" HorizontalAlignment="Stretch">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="300" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                Margin="10,10,10,5"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontWeight="DemiBold"
                                Text="Sensor Tilt Visualization" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                Margin="10,0,10,5"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontStyle="Italic"
                                Text="Use for tilt direction, not amount! Model always scaled to fit" />
                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,0,10,5"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontStyle="Italic"
                                Text="Camera body on top. Scope aperture towards bottom." />
                            <controls:TiltModelControl
                                Grid.Row="3"
                                Grid.Column="0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                AxisColor="{Binding Path=Color, Source={StaticResource BorderBrush}}"
                                PlotBackgroundColor="{Binding Path=Color, Source={StaticResource BackgroundBrush}}"
                                PointColor="{Binding Path=Color, Source={StaticResource SecondaryBrush}}"
                                SurfaceColor="{Binding Path=Color, Source={StaticResource ButtonBackgroundBrush}, Converter={StaticResource SetAlphaToColorConverter}, ConverterParameter=60}"
                                TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                                TiltPlaneModel="{Binding TiltModel.TiltPlaneModel, Mode=OneWay}" />
                        </Grid>
                    </Grid>
                </Expander>
                <Expander
                    Grid.Row="6"
                    Header="Tilt Measurement History"
                    IsExpanded="{Binding TiltMeasurementHistoryActive}"
                    Visibility="{Binding ElementName=ShowAutoFocusTiltMeasurementActivatedOnce, Path=Tag, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <Grid Grid.Column="0" HorizontalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Row="0"
                            Margin="10"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontWeight="DemiBold"
                            Text="Tilt Adjustment History" />
                        <DataGrid
                            Grid.Row="1"
                            Margin="10"
                            HorizontalAlignment="Center"
                            AutoGenerateColumns="False"
                            ColumnWidth="Auto"
                            IsReadOnly="True"
                            ItemsSource="{Binding TiltModel.SensorTiltHistoryModels}"
                            SelectedItem="{Binding TiltModel.SelectedTiltHistoryModel}">
                            <DataGrid.Columns>
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding HistoryId}"
                                    Header="Id" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.TopLeft.AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Top Left" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.TopRight.AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Top Right" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.BottomLeft.AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Bottom Left" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.BottomRight.AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Bottom Right" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=BackfocusFocuserPositionDelta, StringFormat=\{0:0.\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Backfocus Steps" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.Center.RSquared, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Center R²" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.TopLeft.RSquared, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Top Left R²" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.TopRight.RSquared, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Top Right R²" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.BottomLeft.RSquared, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Bottom Left R²" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.BottomRight.RSquared, StringFormat=\{0:0.00\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Bottom Right R²" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Expander>

                <Expander
                    Grid.Row="7"
                    Header="Sensor Model Tilt Measurement"
                    IsExpanded="{Binding TiltMeasurementActive}"
                    Visibility="{Binding ElementName=ShowSensorModelTiltMeasurementActivatedOnce, Path=Tag, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <Grid HorizontalAlignment="Stretch">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0" HorizontalAlignment="Center">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                Margin="10"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontWeight="DemiBold"
                                Text="Tilt Corner Measurements" />
                            <TextBlock
                                Grid.Row="1"
                                Margin="10"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                FontStyle="Italic"
                                Text="Focuser positions below are based on isolated tilt calculations added to the sensor peak position"
                                TextWrapping="Wrap" />
                            <DataGrid
                                Grid.Row="2"
                                Margin="10"
                                HorizontalAlignment="Center"
                                AutoGenerateColumns="False"
                                ColumnWidth="Auto"
                                IsReadOnly="True"
                                ItemsSource="{Binding SensorModel.SensorModelResult.SensorTiltModels}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding SensorSide, Converter={StaticResource HF_EnumStaticDescriptionValueConverter}}"
                                        Header="Side" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding FocuserPosition, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                        Header="Position" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                        Header="Adj Steps" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding AdjustmentRequiredMicrons, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                        Header="Adj Microns" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                        <Grid Grid.Column="1" HorizontalAlignment="Stretch">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="300" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                Margin="10,10,10,5"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontWeight="DemiBold"
                                Text="Sensor Tilt Visualization" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                Margin="10,0,10,5"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontStyle="Italic"
                                Text="Use for tilt direction, not amount! Model always scaled to fit" />
                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,0,10,5"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontStyle="Italic"
                                Text="Camera body on top. Scope aperture towards bottom." />
                            <controls:TiltModelControl
                                Grid.Row="3"
                                Grid.Column="0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                AxisColor="{Binding Path=Color, Source={StaticResource BorderBrush}}"
                                PlotBackgroundColor="{Binding Path=Color, Source={StaticResource BackgroundBrush}}"
                                PointColor="{Binding Path=Color, Source={StaticResource SecondaryBrush}}"
                                SurfaceColor="{Binding Path=Color, Source={StaticResource ButtonBackgroundBrush}, Converter={StaticResource SetAlphaToColorConverter}, ConverterParameter=60}"
                                TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}"
                                TiltPlaneModel="{Binding SensorModel.SensorModelResult.TiltPlaneModel, Mode=OneWay}" />
                        </Grid>
                    </Grid>
                </Expander>
                <Expander
                    Grid.Row="8"
                    Header="Sensor Model Tilt Measurement History"
                    IsExpanded="{Binding TiltMeasurementHistoryActive}"
                    Visibility="{Binding ElementName=ShowSensorModelTiltMeasurementActivatedOnce, Path=Tag, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <Grid Grid.Column="0" HorizontalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Row="0"
                            Margin="10"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontWeight="DemiBold"
                            Text="Tilt Adjustment History" />
                        <DataGrid
                            Grid.Row="1"
                            Margin="10"
                            HorizontalAlignment="Center"
                            AutoGenerateColumns="False"
                            ColumnWidth="Auto"
                            IsReadOnly="True"
                            ItemsSource="{Binding SensorModel.SensorTiltHistoryModels}"
                            SelectedItem="{Binding SensorModel.SelectedTiltHistoryModel}">
                            <DataGrid.Columns>
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding HistoryId}"
                                    Header="Id" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.TopLeft.AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Top Left" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.TopRight.AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Top Right" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.BottomLeft.AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Bottom Left" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltPlaneModel.BottomRight.AdjustmentRequiredSteps, StringFormat=\{0:0.#\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Bottom Right" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=TiltEffectMicrons, StringFormat=\{0:0.\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Tilt Effect" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=CurvatureEffectMicrons, StringFormat=\{0:0.\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Curvature Effect" />
                                <DataGridTextColumn
                                    Width="Auto"
                                    Binding="{Binding Path=AutoFocusOffset, StringFormat=\{0:0.\}, Converter={StaticResource NaNToDoubleDashConverter}}"
                                    Header="Auto Focus Offset" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Expander>

                <Expander
                    Grid.Row="9"
                    Header="FWHM Contour Map"
                    IsExpanded="{Binding FWHMContoursActive}"
                    Visibility="{Binding ExposureAnalysisActivatedOnce, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="400" />
                        </Grid.RowDefinitions>
                        <TextBlock
                            Grid.Row="0"
                            Margin="10"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontWeight="DemiBold"
                            Text="FWHM Contour Map" />
                        <controls:FWHMContourControl
                            Grid.Row="1"
                            Grid.Column="0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            AxisColor="{Binding Path=Color, Source={StaticResource BorderBrush}}"
                            NumRegionsWide="{Binding InspectorOptions.NumRegionsWide, Mode=OneWay}"
                            PlotBackgroundColor="{Binding Path=Color, Source={StaticResource BackgroundBrush}}"
                            PointColor="{Binding Path=Color, Source={StaticResource SecondaryBrush}}"
                            StarDetectionResult="{Binding SnapshotAnalysisStarDetectionResult, Mode=OneWay}"
                            SurfaceColor="{Binding Path=Color, Source={StaticResource ButtonBackgroundBrush}}"
                            TextColor="{Binding Path=Color, Source={StaticResource PrimaryBrush}}" />
                    </Grid>
                </Expander>
                <Expander
                    Grid.Row="9"
                    Header="Eccentricity Vectors"
                    IsExpanded="{Binding EccentricityVectorsActive}"
                    Visibility="{Binding ExposureAnalysisActivatedOnce, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="300" />
                        </Grid.RowDefinitions>
                        <TextBlock
                            Grid.Row="0"
                            Margin="10"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontWeight="DemiBold"
                            Text="Eccentricity" />
                        <controls:ScottPlotControl
                            Grid.Row="1"
                            Plot="{Binding EccentricityVectorPlot}"
                            WpfPlotName="EccentricityVectorPlot" />
                    </Grid>
                </Expander>
            </Grid>
        </ScrollViewer>
    </DataTemplate>
</ResourceDictionary>